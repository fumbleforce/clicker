<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../css/style.css"></link>
        <script src="../js/angular.js"></script>
        <script src="../js/game.js"></script>
    </head>
    <body ng-app="game" ng-controller="DataCtrl">
        <div id="gameWrapper" ng-controller="GameCtrl">
            <div id="topView" class="view">
                <ul class="inlineList center">
                    <li>
                        Wood <span>{{ data.resources.wood | integer }}</span>
                    </li>
                    <li>
                        Stone <span>{{ data.resources.stone | integer }}</span>
                    </li>
                    <li>
                        Food <span>{{ data.resources.food | integer }}</span>
                    </li>
                </ul>
            </div>
            <div id="gameView" class="view" ng-controller="ResourceCtrl">
                <h1 class="centerText title">{{ data.town_name }}</h1>
                
                <button class="tree resource" ng-click="chop_wood()">
                    <img src="../img/tree.png" onmousedown="return false"></img>
                </button>
                
                <button class="stone resource" ng-click="mine_stone()" ng-repeat="i in getNumber(14)" style="left:{{$index}}00px; top:{{ random_top($index) }}px; z-index:{{ random_top($index) }};">
                    <img src="../img/mnt.png" height="200" width="200" onmousedown="return false"></img>
                </button>

                <button class="food resource" ng-click="hunt()">
                    <img src="../img/fox.png" onmousedown="return false"></img>
                </button>

                
            </div>
            <div id="managerView" class="view" ng-controller="ManagerCtrl">

                <div class="left buildingContainer">
                    <div ng-repeat="(key, building) in data.buildings" 
                        ng-init="show_desc=false" 
                        class="building" 
                        ng-class="{'transparent': !can_afford(key)}">

                        <h2 class="textCenter">{{ building.name }}</h2>
                        <br>
                        <div ng-show="show_desc" ng-hide="!show_desc" class="desc">{{ building.desc }}</div>
                        <button ng-mouseover="show_desc=true" ng-mouseleave="show_desc=false">Info</button>
                        <div>Owned: {{ building.owned }}</div>
                        <div>
                            Costs: <span ng-repeat="c in building.cost">{{c.resource}} x{{c.amount}}</span>
                        </div>
                        <button ng-click="buy_building(key)">Buy</button>
                    </div>
                </div>
                <div class="workerContainer">
                    <div class="worker" ng-repeat="(key, unit) in data.units" ng-class="{'transparent': !can_afford(key)}">
                        <h2 class="textCenter">{{ unit.name }}</h2>
                        <br>
                        <div ng-show="show_desc" ng-hide="!show_desc" class="desc">{{ unit.desc }}</div>
                        <button ng-mouseover="show_desc=true" ng-mouseleave="show_desc=false">Info</button>
                        <div>Owned: {{ unit.owned }}</div>
                        <div>
                            Costs: <span ng-repeat="c in unit.cost">{{c.resource}} x{{c.amount}}</span>
                        </div>
                        <button ng-click="buy_worker(key)">Buy</button>
                    </div>
                </div>
                <button ng-click="save()">Save</button>
                <button ng-click="new_game()">New Game</button>
                <input type="text" ng-model="data.town_name" placeholder="{{ data.town_name }}"></input>
            </div>
        </div>
    </body>
</html>
